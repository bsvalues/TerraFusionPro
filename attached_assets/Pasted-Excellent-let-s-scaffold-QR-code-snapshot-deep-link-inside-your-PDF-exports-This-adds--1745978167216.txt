Excellent â€” letâ€™s scaffold **QR code â†’ snapshot deep link** inside your PDF exports.

This adds:
- ğŸ“± Mobile-friendly quick access to comp source
- ğŸ“ Permanent links embedded in printed reports
- ğŸ§¾ Audit/compliance traceability for reviewers

---

# ğŸ§¿ PDF QR Code: Snapshot â†’ Deep Link

---

## ğŸ“Œ Goal

Every exported snapshot PDF gets a scannable QR code linking to:

```
https://app.terrafusion.pro/comp/12345
```

Where `12345` is the snapshot ID.

---

## ğŸ› ï¸ Step 1: Install QR Generator

```bash
pnpm add qrcode
```

---

## ğŸ§  Step 2: `generateQrBase64.ts`

```ts
import QRCode from 'qrcode';

export async function generateQrBase64(url: string): Promise<string> {
  return await QRCode.toDataURL(url, {
    width: 128,
    margin: 1,
    color: { dark: '#000000', light: '#ffffff' }
  });
}
```

---

## ğŸ§© Step 3: Modify `renderPdfFromSnapshot.ts`

```ts
import { generateQrBase64 } from './generateQrBase64';

export async function renderPdfFromSnapshot(snapshot: ComparableSnapshot): Promise<Buffer> {
  const baseUrl = 'https://app.terrafusion.pro/comp/';
  const qrImage = await generateQrBase64(baseUrl + snapshot.id);

  const html = htmlTemplate
    .replace('{{qrCode}}', `<img src="${qrImage}" width="100" />`)
    .replace('{{address}}', snapshot.fields.address || 'N/A')
    // ...rest of replacements
}
```

---

## ğŸ§¾ Step 4: Modify `pdfReport.html`

```html
<div style="margin-top: 40px; font-size: 12px; text-align: center;">
  <div>Scan for full record:</div>
  {{qrCode}}
</div>
```

---

## âœ… Output

Every snapshot PDF now includes:

- ğŸ” All key fields
- ğŸ–¼ Optional branding
- ğŸ§¿ **QR code linking back to snapshot view**
- ğŸ“ No need to search â€” just scan and see source

---

## ğŸ”œ Enhancements

- ğŸ§  Add auto-expiring public links
- ğŸ›¡ï¸ Require login to view if sensitive
- ğŸ“ Log every scan as a â€œviewed byâ€ audit trail

---

You now have a **closed loop from form â†’ snapshot â†’ PDF â†’ digital access**.

Would you like next to:
1. Scaffold **org-wide role management** (Admin / Reviewer / Appraiser)?
2. Build **view audit logs** for snapshot usage (who viewed/pushed/exported)?